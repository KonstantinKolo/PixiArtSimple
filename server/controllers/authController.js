const User = require('../models/user')
const { hashPassword, comparePasswords } = require('../helpers/auth')
const jwt = require('jsonwebtoken');
const UserModel = require('../models/user');

const test = (req, res) => {
  res.json('test is working');
} 


//Register end point
const registerUser = async (req, res) => {
  try{
    const {name, email, password,picCollection, profilePicture} = req.body;
    console.log(profilePicture);
    // Check if name was entered
    if(!name){
      return res.json({
        error: 'name is required'
      })
    }
    // Check if profilePicture was entered
    if(!profilePicture){
      profilePicture = 'data:image/png;base64,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'
    }
    // Check if password is good
    if(!password || password.lenght < 6){
      return res.json({
        error: 'Password is required and should be at least 6 characters long'
      })
    }
    // Check email
    const exist = await User.findOne({email});
    if(exist) {
      return res.json({
        error: 'Email is taken already'
      })
    }

    const hashedPassword = await hashPassword(password)
    const user = await User.create({
      name: name,
      email: email,
      password: hashedPassword,
      picCollection:[],
      profilePicture: profilePicture,
    })

    return res.json(user)
  }
  catch (error) {
    console.log(error)
  }
}

// Login Endpoint
const loginUser = async (req, res) => {
  try{
    const { email, password } = req.body;

    // Check if user exists
    const user = await User.findOne({email});
    if(!user) {
      return res.json({
        error: 'No user found'
      })
    }

    // Check if passwords match
    const match = await comparePasswords(password, user.password)
    if(match) {
      jwt.sign({email: user.email, id: user._id, name: user.name, picCollection: user.picCollection, profilePicture: user.profilePicture}, process.env.JWT_SECRET, {}, (err, token) => {
        if(err) throw err;
        res.cookie('token', token, {
          httpOnly: true,
          sameSite: 'none', // or 'strict' depending on your requirements
          secure: true, // set to true if using HTTPS
        }).json(user);
      })
    }
    if(!match){
      res.json({
        error: 'Passwords do not match'
      })
    }
  } catch (error) { 
    console.log(error);
  }
}

const updatePicCollection  = (req, res) => {
  // const canvas = req.body;
  const canvas = req.body;

  const {token} = req.cookies
  if(token) {
    jwt.verify(token, process.env.JWT_SECRET, {}, async(err, user) => {
      if(err) throw err;

      const email = user.email
      const dbUser = await User.findOne({email});
      const update = dbUser.picCollection;
      update[update.length] = canvas;
      
      if(update.length > 9){
        update.shift();
      }

      await User.findOneAndUpdate({email:email}, {picCollection: update}, {
        new: true
      })
    })
  } else {
    res.json(null);
  }
}


const getProfile = (req, res) => {
  const {token} = req.cookies;
  if(token) {
    jwt.verify(token, process.env.JWT_SECRET, {}, async(err, user) => {
      if(err) throw err;

      const email = user.email
      const dbUser = await User.findOne({email});
      user.picCollection = dbUser.picCollection;
      res.json(user)
    })
  } else {
    res.json(null);
  }
}

module.exports = {
  test,
  registerUser,
  loginUser,
  getProfile,
  updatePicCollection
}